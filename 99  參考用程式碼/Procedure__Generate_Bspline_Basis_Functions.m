clear; clc
Path_MainFolder = 'D:\Google\我的雲端硬碟\學術｜研究與論文\論文著作\CDI Method';


%% Generate matrix M

Path_CDI = fullfile(Path_MainFolder, 'Code', '03  條件密度積分方法（CDI method）');
addpath(Path_CDI);

k = 4;
M = Bspline_basis_matrix(k);
B = Bspline_basis_functions(k);

disp(M);

for i = 1:k
    fprintf('B{%d}(y) = %s\n', i, char(B{i}));
end

rmpath(Path_CDI);


%% Result

%  k = 4
% 
%     -1     3    -3     1
%      3    -6     3     0
%     -3     0     3     0
%      1     4     1     0
% 
%   B{1}(y) = y^2/2 - y/2 - y^3/6 + 1/6
%   B{2}(y) = y^3/2 - y^2 + 2/3
%   B{3}(y) = y/2 + y^2/2 - y^3/2 + 1/6
%   B{4}(y) = y^3/6
% 
% 
%  k = 5
% 
%      1    -4     6    -4     1
%     -4    12   -12     4     0
%      6    -6    -6     6     0
%     -4   -12    12     4     0
%      1    11    11     1     0
% 
%   B{1}(y) = y^2/4 - y/6 - y^3/6 + y^4/24 + 1/24
%   B{2}(y) = y^3/2 - y^2/4 - y/2 - y^4/6 + 11/24
%   B{3}(y) = y/2 - y^2/4 - y^3/2 + y^4/4 + 11/24
%   B{4}(y) = y/6 + y^2/4 + y^3/6 - y^4/6 + 1/24
%   B{5}(y) = y^4/24
% 
% 
%  k = 6
% 
%     -1     5   -10    10    -5     1
%      5   -20    30   -20     5     0
%    -10    20     0   -20    10     0
%     10    20   -60    20    10     0
%     -5   -50     0    50     5     0
%      1    26    66    26     1     0
% 
% 
%  k = 7
% 
%      1    -6    15   -20    15    -6     1
%     -6    30   -60    60   -30     6     0
%     15   -45    30    30   -45    15     0
%    -20   -20   160  -160    20    20     0
%     15   135  -150  -150   135    15     0
%     -6  -150  -240   240   150     6     0
%      1    57   302   302    57     1     0
% 
% 
%  k = 8
%
%     -1      7    -21     35    -35     21     -7      1
%      7    -42    105   -140    105    -42      7      0
%    -21     84   -105      0    105    -84     21      0
%     35      0   -315    560   -315      0     35      0
%    -35   -280    665      0   -665    280     35      0
%     21    504    315  -1680    315    504     21      0
%     -7   -392  -1715      0   1715    392      7      0
%      1    120   1191   2416   1191    120      1      0
% 
% 
%  k = 9
% 
%      1     -8     28    -56     70    -56     28     -8      1
%     -8     56   -168    280   -280    168    -56      8      0
%     28   -140    252   -140   -140    252   -140     28      0
%    -56     56    504  -1400   1400   -504    -56     56      0
%     70    490  -1890   1330   1330  -1890    490     70      0
%    -56  -1288    504   5320  -5320   -504   1288     56      0
%     28   1540   5292  -6860  -6860   5292   1540     28      0
%     -8   -952  -8568  -9800   9800   8568    952      8      0
%      1    247   4293  15619  15619   4293    247      1      0

